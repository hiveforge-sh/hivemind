---
phase: 06-template-infrastructure-core
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/templates/types.ts
  - src/templates/index.ts
autonomous: true

must_haves:
  truths:
    - "Template config interfaces exist with all required fields"
    - "Field type definitions support string, number, boolean, enum, array, date"
    - "Entity type config supports required/optional fields with defaults"
  artifacts:
    - path: "src/templates/types.ts"
      provides: "Template configuration interfaces"
      exports: ["TemplateConfig", "EntityTypeConfig", "FieldConfig", "TemplateDefinition"]
    - path: "src/templates/index.ts"
      provides: "Module barrel export"
      exports: ["*"]
  key_links:
    - from: "src/templates/index.ts"
      to: "src/templates/types.ts"
      via: "re-export"
      pattern: "export .* from"
---

<objective>
Define TypeScript interfaces for the template configuration system.

Purpose: These types define the contract for how users specify custom entity types in config.json. All downstream components (registry, validator, schema factory) depend on these interfaces.

Output: `src/templates/types.ts` with all template configuration interfaces.
</objective>

<execution_context>
@C:\Users\Preston\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Preston\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-template-infrastructure-core/06-RESEARCH.md

Key reference files:
@src/types/index.ts (existing Zod schemas - see structure for entity fields)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create template configuration interfaces</name>
  <files>src/templates/types.ts</files>
  <action>
Create `src/templates/types.ts` with the following interfaces:

1. **FieldType** - Union type for supported field types:
   - `'string' | 'number' | 'boolean' | 'enum' | 'array' | 'date' | 'record'`

2. **FieldConfig** - Individual field definition:
   ```typescript
   interface FieldConfig {
     name: string;           // Field name (e.g., "age", "status")
     type: FieldType;        // Data type
     required?: boolean;     // Default false
     default?: unknown;      // Default value if not provided
     enumValues?: string[];  // Required when type is 'enum'
     arrayItemType?: FieldType; // For arrays, type of items (default: string)
     description?: string;   // For documentation/MCP tool descriptions
   }
   ```

3. **EntityTypeConfig** - Entity type definition:
   ```typescript
   interface EntityTypeConfig {
     name: string;           // Entity type name (e.g., "character")
     displayName: string;    // Human-readable name (e.g., "Character")
     pluralName: string;     // Plural form (e.g., "Characters")
     description?: string;   // Description for documentation
     fields: FieldConfig[];  // Custom fields beyond base fields
     icon?: string;          // Optional icon identifier
   }
   ```

4. **TemplateDefinition** - Complete template:
   ```typescript
   interface TemplateDefinition {
     id: string;             // Unique ID (e.g., "worldbuilding")
     name: string;           // Display name (e.g., "Worldbuilding")
     version: string;        // Semantic version (e.g., "1.0.0")
     description?: string;   // Template description
     entityTypes: EntityTypeConfig[];  // Array of entity types
   }
   ```

5. **TemplateConfig** - Full config file structure:
   ```typescript
   interface TemplateConfig {
     templates?: TemplateDefinition[];  // Inline template definitions
     activeTemplate: string;            // ID of template to use
   }
   ```

6. **TemplateRegistryEntry** - Runtime registry entry (extends TemplateDefinition):
   ```typescript
   interface TemplateRegistryEntry extends TemplateDefinition {
     source: 'builtin' | 'config';  // Where template came from
     entityTypeMap: Map<string, EntityTypeConfig>;  // O(1) lookup by entity name
   }
   ```

Export all interfaces. Add JSDoc comments explaining each interface's purpose.

Note: Do NOT use classes - use interfaces and type aliases only. This keeps the types clean and allows for easy serialization.
  </action>
  <verify>
Run `npx tsc --noEmit` - no type errors.
Verify file exists: `ls src/templates/types.ts`
  </verify>
  <done>
All template configuration interfaces defined and exported. TypeScript compiles without errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create module barrel export</name>
  <files>src/templates/index.ts</files>
  <action>
Create `src/templates/index.ts` as the barrel export for the templates module:

```typescript
/**
 * Template system for pluggable entity type definitions.
 *
 * This module enables users to define custom entity types via config
 * without writing code. The worldbuilding template becomes one of many
 * possible templates.
 */

export * from './types.js';
```

Note: Use `.js` extension in imports for ESM compatibility (the project uses `"type": "module"`).
  </action>
  <verify>
Run `npx tsc --noEmit` - compiles successfully.
Verify exports work: `node -e "import('./dist/templates/index.js').then(m => console.log(Object.keys(m)));"` (after build)
  </verify>
  <done>
Module barrel export created. Templates module is importable from `src/templates`.
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. TypeScript compilation passes:
   ```bash
   npm run build
   ```

2. Types are correctly exported:
   ```bash
   # Check the generated .d.ts file includes all exports
   grep -E "^export (interface|type)" dist/templates/types.d.ts
   ```

3. Interfaces match research recommendations:
   - FieldConfig has all required properties (name, type, required, default, enumValues)
   - EntityTypeConfig groups fields with metadata
   - TemplateDefinition includes version for future migrations
</verification>

<success_criteria>
- src/templates/types.ts exists with all 6 interfaces
- src/templates/index.ts exports all types
- `npm run build` completes without errors
- All interfaces have JSDoc documentation
</success_criteria>

<output>
After completion, create `.planning/phases/06-template-infrastructure-core/06-01-SUMMARY.md`
</output>
