---
phase: 02-vault-templates
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - sample-vault/Templates/README.md
  - sample-vault/Events/Roberts Rebellion.md
  - sample-vault/Factions/House Stark.md
  - sample-vault/Lore/The Long Night.md
autonomous: false

must_haves:
  truths:
    - "Template documentation explains usage and field meanings"
    - "Sample entities exist for Event, Faction, Lore types"
    - "MCP server can index new entity types correctly"
    - "User can create new vault entity from template"
  artifacts:
    - path: "sample-vault/Templates/README.md"
      provides: "Template usage documentation"
      min_lines: 50
    - path: "sample-vault/Events/Roberts Rebellion.md"
      provides: "Sample Event entity"
      contains: "type: event"
    - path: "sample-vault/Factions/House Stark.md"
      provides: "Sample Faction entity"
      contains: "type: faction"
    - path: "sample-vault/Lore/The Long Night.md"
      provides: "Sample Lore entity"
      contains: "type: lore"
  key_links:
    - from: "sample-vault/Events/Roberts Rebellion.md"
      to: "sample-vault/Characters/Eddard Stark.md"
      via: "wikilink in participants field"
      pattern: "\\[\\[Eddard Stark\\]\\]"
    - from: "sample-vault/Factions/House Stark.md"
      to: "sample-vault/Locations/Winterfell.md"
      via: "wikilink in headquarters field"
      pattern: "\\[\\[Winterfell\\]\\]"
---

<objective>
Create template documentation and sample entities for new entity types

Purpose: Users need documentation to understand template fields and examples of properly filled-out entities. Sample entities also verify that the MCP server indexes new types correctly.

Output:
- Template README.md with usage guide and field documentation
- Sample Event, Faction, and Lore entities to demonstrate proper usage
- Verification that MCP server indexes new entity types
</objective>

<execution_context>
@C:\Users\Preston\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Preston\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-vault-templates/02-RESEARCH.md
@.planning/phases/02-vault-templates/02-01-SUMMARY.md

# Templates created in Plan 01
@sample-vault/Templates/Character.md
@sample-vault/Templates/Location.md
@sample-vault/Templates/Event.md
@sample-vault/Templates/Faction.md
@sample-vault/Templates/Lore.md
@sample-vault/Templates/Asset.md

# Existing sample entities for reference
@sample-vault/Characters/Eddard Stark.md
@sample-vault/Locations/Winterfell.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create template documentation</name>
  <files>sample-vault/Templates/README.md</files>
  <action>
Create a README.md in sample-vault/Templates/ that documents:

1. **Overview**: Brief explanation of what templates are for and how to use them with Obsidian's Templates plugin.

2. **Using Templates**:
   - Enable Templates plugin in Obsidian Settings > Core plugins
   - Set Templates folder to "Templates" in plugin settings
   - Use Ctrl/Cmd+P > "Insert template" to use a template
   - Replace {{placeholders}} with actual values

3. **Entity Types**: For each template, document:
   - **Character**: People, creatures, NPCs. Key fields: name, age, gender, race, relationships.
   - **Location**: Places from continents to rooms. Key fields: name, category, parent, hierarchy_level, region.
   - **Event**: Historical events, story beats. Key fields: name, date/date_display, participants, locations, outcome.
   - **Faction**: Organizations, houses, guilds. Key fields: name, faction_type, leader, headquarters, goals.
   - **Lore**: World facts, mythology, systems. Key fields: name, category, related_entities, source.
   - **Asset** (CRITICAL for AI image tracking): Generated images with full provenance. Detailed field documentation:
     - file_path: Path to the image file in vault
     - depicts: Array of entity wikilinks this image shows (e.g., `["[[Eddard Stark]]"]`)
     - generator: Tool that created it (ComfyUI, DALL-E, Midjourney, etc.)
     - workflow_id: Reference to ComfyUI workflow used
     - prompt: The positive prompt used for generation
     - negative_prompt: The negative prompt used
     - model: AI model/checkpoint used (e.g., "SDXL 1.0", "flux-dev")
     - seed: Random seed for reproducibility
     - parameters: Additional generation settings (steps, cfg, sampler, etc.)
     - generation_date: When image was generated
     - approved_by: Who approved for canon
     - approval_date: When approved

4. **Asset Example**: Include a complete example showing provenance tracking:
   ```yaml
   id: asset-eddard-portrait-001
   type: asset
   file_path: Assets/eddard-portrait-001.png
   depicts: ["[[Eddard Stark]]"]
   generator: ComfyUI
   workflow_id: "[[character-portrait-v2]]"
   prompt: "portrait of a noble northern lord, grey eyes, dark hair..."
   model: SDXL 1.0
   seed: 42
   ```

5. **Field Reference Table**: Quick reference for common fields across all types:
   - id: Unique identifier (auto or manual)
   - type: Entity type (character, location, event, faction, lore, asset)
   - status: Workflow status (draft, pending, canon, non-canon, archived)
   - importance: Narrative weight (major, minor, background)
   - world: Which world/setting this belongs to
   - canon_authority: Trust level (high, medium, low)
   - tags: Queryable tags for filtering
   - aliases: Alternative names for linking

6. **Hierarchy Example**: Show how locations use parent/children fields:
   - Westeros (continent) > The North (region) > Winterfell (settlement) > Great Hall (building)
   - All in flat Locations/ folder, linked via frontmatter

7. **Common Pitfalls**:
   - Quote wikilinks in frontmatter: `parent: "[[The North]]"` not `parent: [[The North]]`
   - Use spaces not tabs for YAML indentation
   - Keep most fields flat for Obsidian Properties UI compatibility
   - Nested objects (relationships, parameters) require Source mode editing

Keep documentation concise and practical. Target: 100-140 lines (expanded for Asset detail).
  </action>
  <verify>
- File exists: `ls sample-vault/Templates/README.md`
- Contains all entity types: grep "Character\|Location\|Event\|Faction\|Lore\|Asset" sample-vault/Templates/README.md
- Contains pitfall section: grep -i "pitfall\|common" sample-vault/Templates/README.md
  </verify>
  <done>
Template README.md created with usage instructions, entity type documentation, field reference, hierarchy example, and common pitfalls.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create sample entities for new types</name>
  <files>
    sample-vault/Events/Roberts Rebellion.md
    sample-vault/Factions/House Stark.md
    sample-vault/Lore/The Long Night.md
  </files>
  <action>
Create sample entities that demonstrate proper template usage. Use Westeros/Game of Thrones content to match existing samples.

**Events/Roberts Rebellion.md**:
```yaml
---
id: event-roberts-rebellion
type: event
status: canon
importance: major
world: Westeros
name: Robert's Rebellion
date: 283 AC
date_start: 282 AC
date_end: 283 AC
date_display: "282-283 AC"
event_type: war
participants:
  - "[[Eddard Stark]]"
  - "[[Robert Baratheon]]"
locations:
  - "[[The Trident]]"
  - "[[King's Landing]]"
factions:
  - "[[House Stark]]"
  - "[[House Baratheon]]"
outcome: Targaryen dynasty overthrown
consequences:
  - Robert Baratheon crowned king
  - Eddard Stark returns to Winterfell
tags: [rebellion, war, major-event]
created: {{date:YYYY-MM-DD}}
updated: {{date:YYYY-MM-DD}}
canon_authority: high
---

# Robert's Rebellion

## Summary
A civil war that ended the Targaryen dynasty...

## Participants
- [[Eddard Stark]] - Led northern forces
- [[Robert Baratheon]] - Leader of the rebellion

## Timeline
- 282 AC: War begins after Lyanna Stark's abduction
- 283 AC: Battle of the Trident, sack of King's Landing

## Outcome
Robert Baratheon crowned King of the Seven Kingdoms.

## Long-term Impact
- End of 300 years of Targaryen rule
- New political alliances formed

## Notes
One of the defining events of recent Westerosi history.
```

**Factions/House Stark.md**:
```yaml
---
id: faction-house-stark
type: faction
status: canon
importance: major
world: Westeros
name: House Stark
faction_type: house
leader: "[[Eddard Stark]]"
members:
  - "[[Catelyn Stark]]"
  - "[[Robb Stark]]"
  - "[[Sansa Stark]]"
headquarters: "[[Winterfell]]"
founded: Age of Heroes
goals:
  - Protect the North
  - Honor and duty
resources:
  - Winterfell castle
  - Northern armies
allies:
  - "[[House Tully]]"
rivals:
  - "[[House Lannister]]"
tags: [great-house, north, winter]
created: {{date:YYYY-MM-DD}}
updated: {{date:YYYY-MM-DD}}
canon_authority: high
---

# House Stark

## Overview
The ancient Great House of the North...

## Leadership
Lord [[Eddard Stark]], Warden of the North.

## Goals and Motivations
- Protect the realm from threats beyond the Wall
- Uphold family honor and duty

## History
Founded in the Age of Heroes by Bran the Builder.

## Relationships
- Allied with [[House Tully]] through marriage
- Rivals of [[House Lannister]]

## Notes
Words: "Winter is Coming"
```

**Lore/The Long Night.md**:
```yaml
---
id: lore-the-long-night
type: lore
status: canon
importance: major
world: Westeros
name: The Long Night
category: history
related_entities:
  - "[[The Wall]]"
  - "[[Night's Watch]]"
  - "[[White Walkers]]"
source: in-world
tags: [history, legend, winter]
created: {{date:YYYY-MM-DD}}
updated: {{date:YYYY-MM-DD}}
canon_authority: high
---

# The Long Night

## Description
A legendary period of darkness and cold that lasted a generation...

## In-World Knowledge
Ancient texts describe a winter that lasted a generation. The White Walkers descended from the far north.

## Out-of-World Notes
The Long Night is central to the mythology of Westeros and may recur.

## Related Entries
- [[The Wall]] - Built to protect against future Long Nights
- [[Night's Watch]] - Founded to guard against the threat
```

Replace {{date:YYYY-MM-DD}} with actual date: 2026-01-24 (to match existing samples).
  </action>
  <verify>
- Files exist: `ls sample-vault/Events/ sample-vault/Factions/ sample-vault/Lore/`
- Valid frontmatter: `node -e "const fm = require('gray-matter'); const fs = require('fs'); console.log(fm(fs.readFileSync('sample-vault/Events/Roberts Rebellion.md')).data.type)"`
- Cross-references work: grep "Eddard Stark" sample-vault/Events/Roberts\ Rebellion.md
  </verify>
  <done>
3 sample entities created: Roberts Rebellion (Event), House Stark (Faction), The Long Night (Lore). Each has complete frontmatter and cross-references to existing entities.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete vault template system:
- 6 template files (Character, Location, Event, Faction, Lore, Asset)
- Extended Zod schemas for all entity types
- Location hierarchy support (parent, children, hierarchy_level)
- Template documentation (README.md)
- Sample entities for Event, Faction, Lore types
  </what-built>
  <how-to-verify>
1. Start the MCP server:
   ```bash
   npm run build && npm start
   ```

2. Verify templates exist and parse correctly:
   ```bash
   ls sample-vault/Templates/
   # Should show 6 template files + README.md
   ```

3. Test that MCP server indexes new entity types:
   - Use an MCP client to call search_vault with filters for type: event, faction, lore
   - Verify Roberts Rebellion, House Stark, The Long Night appear in results

4. (Optional) Open sample-vault in Obsidian:
   - Check that frontmatter displays in Properties panel
   - Verify wikilinks resolve correctly
   - Test using a template to create a new note
  </how-to-verify>
  <resume-signal>Type "approved" to confirm templates work correctly, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:

1. Template documentation exists:
   ```bash
   wc -l sample-vault/Templates/README.md
   # Should be 80-120 lines
   ```

2. Sample entities exist:
   ```bash
   ls sample-vault/Events/ sample-vault/Factions/ sample-vault/Lore/
   # Should show: Roberts Rebellion.md, House Stark.md, The Long Night.md
   ```

3. All entities have valid frontmatter:
   ```bash
   for f in sample-vault/{Events,Factions,Lore}/*.md; do
     node -e "const fm = require('gray-matter'); const fs = require('fs'); const d = fm(fs.readFileSync('$f')).data; console.log('$f:', d.type, d.status)"
   done
   ```

4. Cross-references exist:
   ```bash
   grep -l "Eddard Stark" sample-vault/Events/*.md sample-vault/Factions/*.md
   # Should find references in both files
   ```
</verification>

<success_criteria>
- Template README.md created with comprehensive documentation
- 3 sample entities created (Event, Faction, Lore)
- All entities cross-reference existing content
- MCP server indexes new entity types correctly
- Human verification confirms templates work in Obsidian
</success_criteria>

<output>
After completion, create `.planning/phases/02-vault-templates/02-02-SUMMARY.md`
</output>
