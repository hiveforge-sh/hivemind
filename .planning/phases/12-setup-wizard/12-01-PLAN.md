---
phase: 12-setup-wizard
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/cli/shared/colors.ts
  - src/cli/shared/clipboard.ts
  - src/cli/init/validators.ts
autonomous: true

must_haves:
  truths:
    - "Dependencies @inquirer/prompts, picocolors, clipboardy are installed"
    - "Color utility provides green for success, red for errors"
    - "Clipboard utility can copy text to clipboard with error handling"
    - "Vault path validator rejects non-existent paths with clear message"
  artifacts:
    - path: "src/cli/shared/colors.ts"
      provides: "Minimal color wrapper around picocolors"
      exports: ["success", "error", "dim", "bold"]
    - path: "src/cli/shared/clipboard.ts"
      provides: "Cross-platform clipboard with error handling"
      exports: ["copyToClipboard"]
    - path: "src/cli/init/validators.ts"
      provides: "Input validation functions for wizard prompts"
      exports: ["validateVaultPath", "validatePresetFile"]
  key_links:
    - from: "src/cli/shared/colors.ts"
      to: "picocolors"
      via: "import"
      pattern: "import pc from 'picocolors'"
    - from: "src/cli/shared/clipboard.ts"
      to: "clipboardy"
      via: "import"
      pattern: "import clipboard from 'clipboardy'"
---

<objective>
Install CLI dependencies and create shared utilities for the setup wizard.

Purpose: Establishes the foundation for the interactive wizard with color output and clipboard support.
Output: New dependencies installed, shared color/clipboard utilities, vault path validation.
</objective>

<execution_context>
@C:\Users\Preston\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Preston\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/12-setup-wizard/12-CONTEXT.md
@.planning/phases/12-setup-wizard/12-RESEARCH.md
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install wizard dependencies</name>
  <files>package.json</files>
  <action>
Install the required dependencies for the interactive wizard:
- @inquirer/prompts (interactive CLI prompts)
- picocolors (terminal color styling)
- clipboardy (cross-platform clipboard)

Run: npm install @inquirer/prompts picocolors clipboardy

These are production dependencies (not devDependencies) because the CLI runs in user environments.
  </action>
  <verify>
Run `npm ls @inquirer/prompts picocolors clipboardy` - all three should be listed.
Check package.json contains all three in dependencies section.
  </verify>
  <done>
@inquirer/prompts, picocolors, and clipboardy appear in package.json dependencies.
npm install completes without errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create shared CLI utilities</name>
  <files>src/cli/shared/colors.ts, src/cli/shared/clipboard.ts</files>
  <action>
Create src/cli/shared/ directory and two utility modules:

**colors.ts** - Minimal wrapper around picocolors:
```typescript
import pc from 'picocolors';

export const success = (text: string) => pc.green(text);
export const error = (text: string) => pc.red(text);
export const dim = (text: string) => pc.dim(text);
export const bold = (text: string) => pc.bold(text);
export const warn = (text: string) => pc.yellow(text);
```

**clipboard.ts** - Cross-platform clipboard wrapper with error handling:
```typescript
import clipboard from 'clipboardy';

export async function copyToClipboard(text: string): Promise<boolean> {
  try {
    await clipboard.write(text);
    return true;
  } catch {
    // Clipboard may not be available in all environments (CI, SSH, etc.)
    return false;
  }
}
```

Why wrappers:
- Consistent API across the codebase
- Single point to handle edge cases (clipboard unavailable, etc.)
- Easier testing (can mock the wrapper)
  </action>
  <verify>
Files exist at src/cli/shared/colors.ts and src/cli/shared/clipboard.ts.
TypeScript compilation succeeds: npm run build
  </verify>
  <done>
src/cli/shared/colors.ts exports success, error, dim, bold, warn functions.
src/cli/shared/clipboard.ts exports copyToClipboard function with error handling.
Build passes without TypeScript errors.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create validators module</name>
  <files>src/cli/init/validators.ts</files>
  <action>
Create src/cli/init/ directory and validators.ts module:

**validators.ts** - Input validation for wizard prompts:
```typescript
import { existsSync, statSync, readFileSync } from 'fs';
import { resolve } from 'path';

/**
 * Validate vault path for @inquirer/input.
 * Returns true if valid, error message string if invalid.
 */
export function validateVaultPath(value: string): true | string {
  const trimmed = value.trim();

  if (!trimmed) {
    return 'Vault path is required';
  }

  const resolved = resolve(trimmed);

  if (!existsSync(resolved)) {
    return `Path does not exist: ${resolved}`;
  }

  const stats = statSync(resolved);
  if (!stats.isDirectory()) {
    return `Path is not a directory: ${resolved}`;
  }

  return true;
}

/**
 * Validate preset config file for --config flag.
 * Returns parsed config object or throws error.
 */
export function validatePresetFile(filePath: string): Record<string, unknown> {
  const resolved = resolve(filePath);

  if (!existsSync(resolved)) {
    throw new Error(`Preset file not found: ${resolved}`);
  }

  try {
    const content = readFileSync(resolved, 'utf-8');
    return JSON.parse(content);
  } catch (err) {
    if (err instanceof SyntaxError) {
      throw new Error(`Invalid JSON in preset file: ${err.message}`);
    }
    throw err;
  }
}

/**
 * Check if a config.json already exists in the target directory.
 */
export function configExists(dir: string): boolean {
  return existsSync(resolve(dir, 'config.json'));
}
```

This follows the @inquirer/input validation pattern: return true for valid, error string for invalid.
  </action>
  <verify>
File exists at src/cli/init/validators.ts.
TypeScript compilation succeeds: npm run build
  </verify>
  <done>
src/cli/init/validators.ts exports validateVaultPath, validatePresetFile, configExists.
validateVaultPath returns true for valid directories, error string for invalid.
Build passes without TypeScript errors.
  </done>
</task>

</tasks>

<verification>
1. npm ls @inquirer/prompts picocolors clipboardy - all three listed
2. npm run build - compiles without errors
3. src/cli/shared/ and src/cli/init/ directories exist with expected files
</verification>

<success_criteria>
- Dependencies installed: @inquirer/prompts, picocolors, clipboardy in package.json
- Colors utility created with success/error/dim/bold exports
- Clipboard utility created with copyToClipboard export and error handling
- Validators module created with validateVaultPath and validatePresetFile exports
- TypeScript build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/12-setup-wizard/12-01-SUMMARY.md`
</output>
